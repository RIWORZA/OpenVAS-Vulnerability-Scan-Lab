<h1>OpenVAS Vulneranbility Scan Lab</h1>


<h2>Description</h2>
In this project I setup two VMs.  One is acting as the vulnerable machine is is running Windows 10, while the other is hosting OpenVAS a vulnerability management scanner.  I drop the firewall on the Windows 10 VM and install some outdated software and then run some scans.  For this I ran both unauthenticated and credentialed scans and then tried remmidiating the vulnerabilities found.  After I verfied with running another credentialed scan to show that the number of vulnerabilities are lower than before.

<br />

<b>Prerequisites</b>
- <b>Computer with Internet</b>
- <b>Azure Account - I had to use a pay as you go model to access OpenVAS on the market place</b>

<h2>Languages and Utilities Used</h2>
- <b>OpenVAS</b> <br />
- <b>Azure VM</b><br />
- <b>10.0 AdobeReader</b><br />
- <b>Firefox 97.0b5</b><br />
- <b>VLC 1.1.7</b><br />


<h2>Environments Used </h2>

- <b>Windows 10</b> (22h2)

<h2>Project Walkthrough</h2>

<p align="center">
Step 1: I first navigated to my Microsoft Azure account and accessed the marketplace.  Once there I found the vulnerability scanner we will be using called OpenVAS.  I started with a pre-set configuration and created a VM.  Things to note is are the region and Vnet we select for this lab I went with East US 2.<br/>
<img src="https://i.imgur.com/briRhwn.png" height="80%" width="80%" alt="Disk Sanitization Steps"/></br>
<img src="https://i.imgur.com/oQobJd5.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
Step: 2 Once the VM is created I SSH into it with cmd and used the credentials I assigned it when creating the VM.  Once signed OpenVAS will automatically install and deploy.  At the end of deployment you should see %username%@openvas along with the web app URL and username and password to access it.  For mine I had address: https://172.177.254.107.c.hossted.com<br/>
<br/>
<img src="https://i.imgur.com/mpGCEQt.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br/>
Step: 3 Navigating to the URL I was prompted with credentials to sign in.  For me the password that was provided was not working so I ended up using the username/password admin/admin.  This is what the web application will look like on first sign in.<br/>
<img src="https://i.imgur.com/rwFPm6j.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
Step: 4 The next thing I did was configure and delpoy my Windows 10 VM.  On this VM we will be disabling the firewall, as well as, install applications that are very outdated and have many known vulnerabilities on them.  Here are the basic configurations I used for this VM.  Note that I used the same region and Vnet that was used in the OpenVAS VM.  
<img src="https://i.imgur.com/E3nRcBH.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
Step: 5 After deployment is completed on the VM I then moved to start making the machine vulnerable by disabling the firewall and install outdated software.  I used 3 different applications that are outdated and have many known vulnerabilities.  Software I downloaded for this are: Firefox 97.0b5, VLC 1.1.7, and AdobeReader 10.0<br/>
<img src="https://i.imgur.com/ejFDaxk.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
Step: 6 Once everything is set on the Windows 10 VM I accessed OpenVAS again to begin configuration so I can begin scanning. 
For this I will configure a new host using the Windows 10 VM private IP.  You can find this by accessing the Virtual Machines in Azure portal.  For mine my private IP is 10.0.0.5. 
 <br/>
<img src="https://i.imgur.com/2t2RnPO.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
<br/>
Step: 7 For the first scan I started with is an unauthenticated scan.  This is a scan that is performed without valid login credentials and will not go too deep but is faster than a credentialed scan.  <br/>
<img src="https://i.imgur.com/nf35Daj.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
Step: 8 After running we see that is has given the a severity score of medium and when looking in the details we can see some of the vulnerabilities discovered.  There were only 3 vulnerabilities that were found that reached a severity of medium.<br/>
<img src="https://i.imgur.com/BZ4Zk4x.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://i.imgur.com/c61Eam3.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br/>
Step: 9 The next scan I will run is a credentialed scan.  This scan is started with authorized login credentials and will evaluate the system from an insider's perspective.  The scan itself takes a longer and will be more in-depth when detecting vulnerabilities.<br/>
<img src="https://i.imgur.com/48Vflrt.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://i.imgur.com/0DBPKPE.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br />
Step 10 This scan took about 20 minutes to complete and ended witha severity score of 10 which is labeled as high.  Taking a deeper look at the scan we see a lot more vulnerabilities found and can see that they are all tied to the outdated software we installed on the VM.  For this particular scan we found 88 high severity vulnerabilities.
<br/>
<br/>
<img src="https://i.imgur.com/zWnzqaj.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<img src="https://i.imgur.com/JcXmieG.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
<br/>
Step 11 Now to remmediate the vulnerabilites I have two options moving forward. I can either update the applications or remove them from the system.  In this case I chose to uninstall all the applications.  After I ran another credentialed scan and you can see that the amount of high severity vulnerabilities are no longer there.
<br/>
<img src="https://i.imgur.com/flLH4wA.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>

<h2>Closing Thoughts</h2>
I said that there are two options I had moving forward, but that might not be the case in a live environment for an organization.  Sometimes uninstalling or updating an application is not an option for some organizations.  In some cases the application may have vulnerabilities, but it has no patches or updates to be made, and using that application is critical to business operations so we can't just remove it from the system.  What would you do here?  Well I would want to see if there are any additional controls we can put in place to reduce the risk of said vulnerabilities.  Doing an risk assessment on those said vulnerabilities and putting in any additional controls to reduce the risk to an acceptable level would be an acceptable step forward as well.
<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
